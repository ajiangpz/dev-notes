{
  "title": "使用 canvas 实现灰度化图片",
  "date": "2016-03-08T00:00:00.000Z",
  "tags": [
    "canvas"
  ],
  "draft": false,
  "summary": "\r",
  "body": {
    "raw": "\r\n### React 和 Canvas: 使用 ImageData 处理图片灰度化效果\r\n\r\n在这篇博客中，我们将创建一个简单的 React 应用程序，通过 Canvas 和 `ImageData` 对图片进行灰度化处理。具体来说，我们将加载图片，将其绘制在 Canvas 上，提取图片数据，然后遍历和修改像素数据实现灰度效果。\r\n\r\n#### 步骤 1：项目准备\r\n\r\n首先，创建一个新的 React 组件，在项目文件夹下创建一个 `Page.tsx` 文件，将会在该组件中完成图片的处理工作。代码的整体结构如下：\r\n\r\n```typescript\r\n\"use client\";\r\nimport React, { useEffect, useRef } from \"react\";\r\n\r\nexport default function Page() {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n  useEffect(() => {\r\n    // 主逻辑在此执行\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <canvas id=\"canvas\" ref={canvasRef}></canvas>\r\n    </div>\r\n  );\r\n}\r\n```\r\n\r\n### 核心功能实现\r\n\r\n我们将以下功能逐步实现：\r\n\r\n1.  加载图片并将其绘制在 Canvas 上。\r\n2.  获取图片的 `ImageData`。\r\n3.  遍历 `ImageData` 中的像素数据，实现灰度化处理。\r\n\r\n#### 加载图片\r\n\r\n在 React 中，可以通过 `useEffect` 钩子在组件渲染后加载图片。这里定义了一个 `loadImage` 函数，通过 `Image` 对象加载图片并返回一个 Promise：\r\n\r\n```typescript\r\n// 加载图片并返回 HTMLImageElement\r\nfunction loadImage(url: string) {\r\n  return new Promise<HTMLImageElement>((resolve, reject) => {\r\n    const img = new Image();\r\n    img.crossOrigin = \"anonymous\"; // 允许跨域加载图片\r\n    img.onload = () => resolve(img);\r\n    img.onerror = reject;\r\n    img.src = url;\r\n  });\r\n}\r\n```\r\n\r\n在 `useEffect` 中调用 `loadImage` 函数加载图片。加载完成后，我们将图片绘制到 Canvas 上。\r\n\r\n#### 绘制图片\r\n\r\n接下来创建一个 `drawImage` 函数，用于将加载的图片绘制在 Canvas 上。可以通过 Canvas 的 `2D` 上下文实现：\r\n\r\n```typescript\r\nfunction drawImage(image: HTMLImageElement, canvas: HTMLCanvasElement) {\r\n  const ctx = canvas.getContext(\"2d\");\r\n  if (ctx) {\r\n    ctx.drawImage(image, 0, 0); // 在 Canvas 上绘制图片\r\n  }\r\n}\r\n```\r\n\r\n在 `useEffect` 中，当图片加载完毕后调用该函数，确保图片已经绘制在 Canvas 上。\r\n\r\n#### 获取 ImageData\r\n\r\n为了进行灰度化处理，我们需要先从图片中获取像素数据。使用 `OffscreenCanvas` 来提取图片的 `ImageData` 数据，这样就不需要在 Canvas 上显示图片：\r\n\r\n```typescript\r\nfunction getImageData(\r\n  img: HTMLImageElement,\r\n  rect: [number, number, number, number]\r\n) {\r\n  const canvas = new OffscreenCanvas(img.width, img.height); // 创建一个 OffscreenCanvas\r\n  const ctx = canvas.getContext(\"2d\");\r\n  ctx?.drawImage(img, 0, 0); // 绘制图片\r\n  const imageData = ctx?.getImageData(...rect); // 获取指定区域的 ImageData\r\n  return imageData;\r\n}\r\n```\r\n\r\n在 `useEffect` 中调用 `getImageData` 获取整个图片的像素数据。\r\n\r\n#### 遍历和修改 ImageData 数据\r\n\r\n现在我们已经获得了图片的像素数据（`ImageData`），我们可以对它进行处理。这里我们将实现灰度化效果，将每个像素的 RGB 值设置为平均值。\r\n\r\n```typescript\r\nfunction traverseImageData(imageData: ImageData) {\r\n  for (let i = 0; i < imageData.data.length; i += 4) {\r\n    const r = imageData.data[i];\r\n    const g = imageData.data[i + 1];\r\n    const b = imageData.data[i + 2];\r\n    const avg = (r + g + b) / 3; // 计算 RGB 平均值\r\n    imageData.data[i] = avg;\r\n    imageData.data[i + 1] = avg;\r\n    imageData.data[i + 2] = avg;\r\n  }\r\n}\r\n```\r\n\r\n遍历 `imageData.data` 数组，每四个元素代表一个像素的 RGBA 值。将 `r`、`g`、`b` 赋值为平均值，实现灰度化。\r\n\r\n#### 整合代码\r\n\r\n将所有代码整合在 `useEffect` 中，使得页面加载时自动加载、处理并显示图片。\r\n\r\n```typescript\r\nexport default function Page() {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      const canvas = canvasRef.current;\r\n      if (!canvas) return;\r\n\r\n      const context = canvas.getContext(\"2d\");\r\n      const img = await loadImage(\r\n        \"https://plus.unsplash.com/premium_photo-1664474619075-644dd191935f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8aW1hZ2V8ZW58MHx8MHx8fDA%3D\"\r\n      );\r\n\r\n      // 设置 Canvas 尺寸以匹配图片尺寸\r\n      canvas.width = img.width;\r\n      canvas.height = img.height;\r\n\r\n      // 获取图片数据\r\n      const imageData = getImageData(img, [0, 0, img.width, img.height]);\r\n      if (!imageData) return;\r\n\r\n      // 应用灰度化\r\n      traverseImageData(imageData);\r\n\r\n      // 将修改后的数据重新绘制到 Canvas 上\r\n      if (context) {\r\n        context.putImageData(imageData, 0, 0);\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <canvas id=\"canvas\" ref={canvasRef}></canvas>\r\n    </div>\r\n  );\r\n}\r\n```\r\n\r\n#### 效果展示\r\n\r\n- [canvas灰度化图片](/projects/canvas/gray)\r\n\r\n\r\n",
    "code": "var Component=(()=>{var h=Object.create;var l=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var g=(e,a)=>()=>(a||e((a={exports:{}}).exports,a),a.exports),w=(e,a)=>{for(var s in a)l(e,s,{get:a[s],enumerable:!0})},i=(e,a,s,t)=>{if(a&&typeof a==\"object\"||typeof a==\"function\")for(let c of u(a))!k.call(e,c)&&c!==s&&l(e,c,{get:()=>a[c],enumerable:!(t=m(a,c))||t.enumerable});return e};var f=(e,a,s)=>(s=e!=null?h(N(e)):{},i(a||!e||!e.__esModule?l(s,\"default\",{value:e,enumerable:!0}):s,e)),v=e=>i(l({},\"__esModule\",{value:!0}),e);var r=g((I,o)=>{o.exports=_jsx_runtime});var x={};w(x,{default:()=>d,frontmatter:()=>y});var n=f(r()),y={title:\"\\u4F7F\\u7528 canvas \\u5B9E\\u73B0\\u7070\\u5EA6\\u5316\\u56FE\\u7247\",date:\"2016-03-08\",tags:[\"canvas\"],draft:!1,summary:null};function p(e){let a={a:\"a\",code:\"code\",h3:\"h3\",h4:\"h4\",li:\"li\",ol:\"ol\",p:\"p\",path:\"path\",pre:\"pre\",span:\"span\",svg:\"svg\",ul:\"ul\",...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.h3,{className:\"content-header\",id:\"react-\\u548C-canvas-\\u4F7F\\u7528-imagedata-\\u5904\\u7406\\u56FE\\u7247\\u7070\\u5EA6\\u5316\\u6548\\u679C\",children:[(0,n.jsx)(a.a,{href:\"#react-\\u548C-canvas-\\u4F7F\\u7528-imagedata-\\u5904\\u7406\\u56FE\\u7247\\u7070\\u5EA6\\u5316\\u6548\\u679C\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.span,{className:\"content-header-link\",children:(0,n.jsxs)(a.svg,{className:\"h-5 linkicon w-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:[(0,n.jsx)(a.path,{d:\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}),(0,n.jsx)(a.path,{d:\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"})]})})})}),\"React \\u548C Canvas: \\u4F7F\\u7528 ImageData \\u5904\\u7406\\u56FE\\u7247\\u7070\\u5EA6\\u5316\\u6548\\u679C\"]}),(0,n.jsxs)(a.p,{children:[\"\\u5728\\u8FD9\\u7BC7\\u535A\\u5BA2\\u4E2D\\uFF0C\\u6211\\u4EEC\\u5C06\\u521B\\u5EFA\\u4E00\\u4E2A\\u7B80\\u5355\\u7684 React \\u5E94\\u7528\\u7A0B\\u5E8F\\uFF0C\\u901A\\u8FC7 Canvas \\u548C \",(0,n.jsx)(a.code,{children:\"ImageData\"}),\" \\u5BF9\\u56FE\\u7247\\u8FDB\\u884C\\u7070\\u5EA6\\u5316\\u5904\\u7406\\u3002\\u5177\\u4F53\\u6765\\u8BF4\\uFF0C\\u6211\\u4EEC\\u5C06\\u52A0\\u8F7D\\u56FE\\u7247\\uFF0C\\u5C06\\u5176\\u7ED8\\u5236\\u5728 Canvas \\u4E0A\\uFF0C\\u63D0\\u53D6\\u56FE\\u7247\\u6570\\u636E\\uFF0C\\u7136\\u540E\\u904D\\u5386\\u548C\\u4FEE\\u6539\\u50CF\\u7D20\\u6570\\u636E\\u5B9E\\u73B0\\u7070\\u5EA6\\u6548\\u679C\\u3002\"]}),(0,n.jsxs)(a.h4,{className:\"content-header\",id:\"\\u6B65\\u9AA4-1\\u9879\\u76EE\\u51C6\\u5907\",children:[(0,n.jsx)(a.a,{href:\"#\\u6B65\\u9AA4-1\\u9879\\u76EE\\u51C6\\u5907\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.span,{className:\"content-header-link\",children:(0,n.jsxs)(a.svg,{className:\"h-5 linkicon w-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:[(0,n.jsx)(a.path,{d:\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}),(0,n.jsx)(a.path,{d:\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"})]})})})}),\"\\u6B65\\u9AA4 1\\uFF1A\\u9879\\u76EE\\u51C6\\u5907\"]}),(0,n.jsxs)(a.p,{children:[\"\\u9996\\u5148\\uFF0C\\u521B\\u5EFA\\u4E00\\u4E2A\\u65B0\\u7684 React \\u7EC4\\u4EF6\\uFF0C\\u5728\\u9879\\u76EE\\u6587\\u4EF6\\u5939\\u4E0B\\u521B\\u5EFA\\u4E00\\u4E2A \",(0,n.jsx)(a.code,{children:\"Page.tsx\"}),\" \\u6587\\u4EF6\\uFF0C\\u5C06\\u4F1A\\u5728\\u8BE5\\u7EC4\\u4EF6\\u4E2D\\u5B8C\\u6210\\u56FE\\u7247\\u7684\\u5904\\u7406\\u5DE5\\u4F5C\\u3002\\u4EE3\\u7801\\u7684\\u6574\\u4F53\\u7ED3\\u6784\\u5982\\u4E0B\\uFF1A\"]}),(0,n.jsx)(a.pre,{className:\"language-typescript\",children:(0,n.jsxs)(a.code,{className:\"language-typescript code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token string\",children:'\"use client\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"import\"}),\" React\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),\" useEffect\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" useRef \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"react\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"Page\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" canvasRef \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(a.span,{className:\"token generic-function\",children:[(0,n.jsx)(a.span,{className:\"token function\",children:\"useRef\"}),(0,n.jsxs)(a.span,{className:\"token class-name generic\",children:[(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\"HTMLCanvasElement\",(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"})]})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token function\",children:\"useEffect\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=>\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u4E3B\\u903B\\u8F91\\u5728\\u6B64\\u6267\\u884C\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\"div\",(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\"canvas id\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"canvas\"'}),\" ref\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),\"canvasRef\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),\"canvas\",(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),\"div\",(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.h3,{className:\"content-header\",id:\"\\u6838\\u5FC3\\u529F\\u80FD\\u5B9E\\u73B0\",children:[(0,n.jsx)(a.a,{href:\"#\\u6838\\u5FC3\\u529F\\u80FD\\u5B9E\\u73B0\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.span,{className:\"content-header-link\",children:(0,n.jsxs)(a.svg,{className:\"h-5 linkicon w-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:[(0,n.jsx)(a.path,{d:\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}),(0,n.jsx)(a.path,{d:\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"})]})})})}),\"\\u6838\\u5FC3\\u529F\\u80FD\\u5B9E\\u73B0\"]}),(0,n.jsx)(a.p,{children:\"\\u6211\\u4EEC\\u5C06\\u4EE5\\u4E0B\\u529F\\u80FD\\u9010\\u6B65\\u5B9E\\u73B0\\uFF1A\"}),(0,n.jsxs)(a.ol,{children:[(0,n.jsx)(a.li,{children:\"\\u52A0\\u8F7D\\u56FE\\u7247\\u5E76\\u5C06\\u5176\\u7ED8\\u5236\\u5728 Canvas \\u4E0A\\u3002\"}),(0,n.jsxs)(a.li,{children:[\"\\u83B7\\u53D6\\u56FE\\u7247\\u7684 \",(0,n.jsx)(a.code,{children:\"ImageData\"}),\"\\u3002\"]}),(0,n.jsxs)(a.li,{children:[\"\\u904D\\u5386 \",(0,n.jsx)(a.code,{children:\"ImageData\"}),\" \\u4E2D\\u7684\\u50CF\\u7D20\\u6570\\u636E\\uFF0C\\u5B9E\\u73B0\\u7070\\u5EA6\\u5316\\u5904\\u7406\\u3002\"]})]}),(0,n.jsxs)(a.h4,{className:\"content-header\",id:\"\\u52A0\\u8F7D\\u56FE\\u7247\",children:[(0,n.jsx)(a.a,{href:\"#\\u52A0\\u8F7D\\u56FE\\u7247\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.span,{className:\"content-header-link\",children:(0,n.jsxs)(a.svg,{className:\"h-5 linkicon w-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:[(0,n.jsx)(a.path,{d:\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}),(0,n.jsx)(a.path,{d:\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"})]})})})}),\"\\u52A0\\u8F7D\\u56FE\\u7247\"]}),(0,n.jsxs)(a.p,{children:[\"\\u5728 React \\u4E2D\\uFF0C\\u53EF\\u4EE5\\u901A\\u8FC7 \",(0,n.jsx)(a.code,{children:\"useEffect\"}),\" \\u94A9\\u5B50\\u5728\\u7EC4\\u4EF6\\u6E32\\u67D3\\u540E\\u52A0\\u8F7D\\u56FE\\u7247\\u3002\\u8FD9\\u91CC\\u5B9A\\u4E49\\u4E86\\u4E00\\u4E2A \",(0,n.jsx)(a.code,{children:\"loadImage\"}),\" \\u51FD\\u6570\\uFF0C\\u901A\\u8FC7 \",(0,n.jsx)(a.code,{children:\"Image\"}),\" \\u5BF9\\u8C61\\u52A0\\u8F7D\\u56FE\\u7247\\u5E76\\u8FD4\\u56DE\\u4E00\\u4E2A Promise\\uFF1A\"]}),(0,n.jsx)(a.pre,{className:\"language-typescript\",children:(0,n.jsxs)(a.code,{className:\"language-typescript code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u52A0\\u8F7D\\u56FE\\u7247\\u5E76\\u8FD4\\u56DE HTMLImageElement\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"loadImage\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"url\",(0,n.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(a.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsxs)(a.span,{className:\"token class-name\",children:[(0,n.jsx)(a.span,{className:\"token builtin\",children:\"Promise\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\"HTMLImageElement\",(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"resolve\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" reject\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=>\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" img \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Image\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"crossOrigin \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"anonymous\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u5141\\u8BB8\\u8DE8\\u57DF\\u52A0\\u8F7D\\u56FE\\u7247\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function function-variable\",children:\"onload\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=>\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"resolve\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"onerror \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" reject\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"src \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" url\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"\\u5728 \",(0,n.jsx)(a.code,{children:\"useEffect\"}),\" \\u4E2D\\u8C03\\u7528 \",(0,n.jsx)(a.code,{children:\"loadImage\"}),\" \\u51FD\\u6570\\u52A0\\u8F7D\\u56FE\\u7247\\u3002\\u52A0\\u8F7D\\u5B8C\\u6210\\u540E\\uFF0C\\u6211\\u4EEC\\u5C06\\u56FE\\u7247\\u7ED8\\u5236\\u5230 Canvas \\u4E0A\\u3002\"]}),(0,n.jsxs)(a.h4,{className:\"content-header\",id:\"\\u7ED8\\u5236\\u56FE\\u7247\",children:[(0,n.jsx)(a.a,{href:\"#\\u7ED8\\u5236\\u56FE\\u7247\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.span,{className:\"content-header-link\",children:(0,n.jsxs)(a.svg,{className:\"h-5 linkicon w-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:[(0,n.jsx)(a.path,{d:\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}),(0,n.jsx)(a.path,{d:\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"})]})})})}),\"\\u7ED8\\u5236\\u56FE\\u7247\"]}),(0,n.jsxs)(a.p,{children:[\"\\u63A5\\u4E0B\\u6765\\u521B\\u5EFA\\u4E00\\u4E2A \",(0,n.jsx)(a.code,{children:\"drawImage\"}),\" \\u51FD\\u6570\\uFF0C\\u7528\\u4E8E\\u5C06\\u52A0\\u8F7D\\u7684\\u56FE\\u7247\\u7ED8\\u5236\\u5728 Canvas \\u4E0A\\u3002\\u53EF\\u4EE5\\u901A\\u8FC7 Canvas \\u7684 \",(0,n.jsx)(a.code,{children:\"2D\"}),\" \\u4E0A\\u4E0B\\u6587\\u5B9E\\u73B0\\uFF1A\"]}),(0,n.jsx)(a.pre,{className:\"language-typescript\",children:(0,n.jsxs)(a.code,{className:\"language-typescript code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"drawImage\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"image\",(0,n.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" HTMLImageElement\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" canvas\",(0,n.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" HTMLCanvasElement\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" ctx \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" canvas\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getContext\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"2d\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    ctx\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"drawImage\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"image\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u5728 Canvas \\u4E0A\\u7ED8\\u5236\\u56FE\\u7247\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"\\u5728 \",(0,n.jsx)(a.code,{children:\"useEffect\"}),\" \\u4E2D\\uFF0C\\u5F53\\u56FE\\u7247\\u52A0\\u8F7D\\u5B8C\\u6BD5\\u540E\\u8C03\\u7528\\u8BE5\\u51FD\\u6570\\uFF0C\\u786E\\u4FDD\\u56FE\\u7247\\u5DF2\\u7ECF\\u7ED8\\u5236\\u5728 Canvas \\u4E0A\\u3002\"]}),(0,n.jsxs)(a.h4,{className:\"content-header\",id:\"\\u83B7\\u53D6-imagedata\",children:[(0,n.jsx)(a.a,{href:\"#\\u83B7\\u53D6-imagedata\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.span,{className:\"content-header-link\",children:(0,n.jsxs)(a.svg,{className:\"h-5 linkicon w-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:[(0,n.jsx)(a.path,{d:\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}),(0,n.jsx)(a.path,{d:\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"})]})})})}),\"\\u83B7\\u53D6 ImageData\"]}),(0,n.jsxs)(a.p,{children:[\"\\u4E3A\\u4E86\\u8FDB\\u884C\\u7070\\u5EA6\\u5316\\u5904\\u7406\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u5148\\u4ECE\\u56FE\\u7247\\u4E2D\\u83B7\\u53D6\\u50CF\\u7D20\\u6570\\u636E\\u3002\\u4F7F\\u7528 \",(0,n.jsx)(a.code,{children:\"OffscreenCanvas\"}),\" \\u6765\\u63D0\\u53D6\\u56FE\\u7247\\u7684 \",(0,n.jsx)(a.code,{children:\"ImageData\"}),\" \\u6570\\u636E\\uFF0C\\u8FD9\\u6837\\u5C31\\u4E0D\\u9700\\u8981\\u5728 Canvas \\u4E0A\\u663E\\u793A\\u56FE\\u7247\\uFF1A\"]}),(0,n.jsx)(a.pre,{className:\"language-typescript\",children:(0,n.jsxs)(a.code,{className:\"language-typescript code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getImageData\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  img\",(0,n.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" HTMLImageElement\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  rect\",(0,n.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(a.span,{className:\"token builtin\",children:\"number\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token builtin\",children:\"number\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token builtin\",children:\"number\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token builtin\",children:\"number\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" canvas \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"OffscreenCanvas\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"width\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"height\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u521B\\u5EFA\\u4E00\\u4E2A OffscreenCanvas\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" ctx \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" canvas\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getContext\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"2d\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  ctx\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"?.\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"drawImage\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u7ED8\\u5236\\u56FE\\u7247\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" imageData \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" ctx\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"?.\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getImageData\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"...\"}),\"rect\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u83B7\\u53D6\\u6307\\u5B9A\\u533A\\u57DF\\u7684 ImageData\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"\\u5728 \",(0,n.jsx)(a.code,{children:\"useEffect\"}),\" \\u4E2D\\u8C03\\u7528 \",(0,n.jsx)(a.code,{children:\"getImageData\"}),\" \\u83B7\\u53D6\\u6574\\u4E2A\\u56FE\\u7247\\u7684\\u50CF\\u7D20\\u6570\\u636E\\u3002\"]}),(0,n.jsxs)(a.h4,{className:\"content-header\",id:\"\\u904D\\u5386\\u548C\\u4FEE\\u6539-imagedata-\\u6570\\u636E\",children:[(0,n.jsx)(a.a,{href:\"#\\u904D\\u5386\\u548C\\u4FEE\\u6539-imagedata-\\u6570\\u636E\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.span,{className:\"content-header-link\",children:(0,n.jsxs)(a.svg,{className:\"h-5 linkicon w-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:[(0,n.jsx)(a.path,{d:\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}),(0,n.jsx)(a.path,{d:\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"})]})})})}),\"\\u904D\\u5386\\u548C\\u4FEE\\u6539 ImageData \\u6570\\u636E\"]}),(0,n.jsxs)(a.p,{children:[\"\\u73B0\\u5728\\u6211\\u4EEC\\u5DF2\\u7ECF\\u83B7\\u5F97\\u4E86\\u56FE\\u7247\\u7684\\u50CF\\u7D20\\u6570\\u636E\\uFF08\",(0,n.jsx)(a.code,{children:\"ImageData\"}),\"\\uFF09\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u5BF9\\u5B83\\u8FDB\\u884C\\u5904\\u7406\\u3002\\u8FD9\\u91CC\\u6211\\u4EEC\\u5C06\\u5B9E\\u73B0\\u7070\\u5EA6\\u5316\\u6548\\u679C\\uFF0C\\u5C06\\u6BCF\\u4E2A\\u50CF\\u7D20\\u7684 RGB \\u503C\\u8BBE\\u7F6E\\u4E3A\\u5E73\\u5747\\u503C\\u3002\"]}),(0,n.jsx)(a.pre,{className:\"language-typescript\",children:(0,n.jsxs)(a.code,{className:\"language-typescript code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"traverseImageData\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"imageData\",(0,n.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" ImageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"let\"}),\" i \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\" imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"length\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" r \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" g \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"i \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" b \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"i \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" avg \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"r \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" g \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" b\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u8BA1\\u7B97 RGB \\u5E73\\u5747\\u503C\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"i\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" avg\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"i \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" avg\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"i \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" avg\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"\\u904D\\u5386 \",(0,n.jsx)(a.code,{children:\"imageData.data\"}),\" \\u6570\\u7EC4\\uFF0C\\u6BCF\\u56DB\\u4E2A\\u5143\\u7D20\\u4EE3\\u8868\\u4E00\\u4E2A\\u50CF\\u7D20\\u7684 RGBA \\u503C\\u3002\\u5C06 \",(0,n.jsx)(a.code,{children:\"r\"}),\"\\u3001\",(0,n.jsx)(a.code,{children:\"g\"}),\"\\u3001\",(0,n.jsx)(a.code,{children:\"b\"}),\" \\u8D4B\\u503C\\u4E3A\\u5E73\\u5747\\u503C\\uFF0C\\u5B9E\\u73B0\\u7070\\u5EA6\\u5316\\u3002\"]}),(0,n.jsxs)(a.h4,{className:\"content-header\",id:\"\\u6574\\u5408\\u4EE3\\u7801\",children:[(0,n.jsx)(a.a,{href:\"#\\u6574\\u5408\\u4EE3\\u7801\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.span,{className:\"content-header-link\",children:(0,n.jsxs)(a.svg,{className:\"h-5 linkicon w-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:[(0,n.jsx)(a.path,{d:\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}),(0,n.jsx)(a.path,{d:\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"})]})})})}),\"\\u6574\\u5408\\u4EE3\\u7801\"]}),(0,n.jsxs)(a.p,{children:[\"\\u5C06\\u6240\\u6709\\u4EE3\\u7801\\u6574\\u5408\\u5728 \",(0,n.jsx)(a.code,{children:\"useEffect\"}),\" \\u4E2D\\uFF0C\\u4F7F\\u5F97\\u9875\\u9762\\u52A0\\u8F7D\\u65F6\\u81EA\\u52A8\\u52A0\\u8F7D\\u3001\\u5904\\u7406\\u5E76\\u663E\\u793A\\u56FE\\u7247\\u3002\"]}),(0,n.jsx)(a.pre,{className:\"language-typescript\",children:(0,n.jsxs)(a.code,{className:\"language-typescript code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"Page\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" canvasRef \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(a.span,{className:\"token generic-function\",children:[(0,n.jsx)(a.span,{className:\"token function\",children:\"useRef\"}),(0,n.jsxs)(a.span,{className:\"token class-name generic\",children:[(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\"HTMLCanvasElement\",(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"})]})]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token function\",children:\"useEffect\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=>\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" canvas \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" canvasRef\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"current\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"!\"}),\"canvas\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" context \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" canvas\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getContext\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"2d\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" img \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"await\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"loadImage\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"https://plus.unsplash.com/premium_photo-1664474619075-644dd191935f?w=800&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8aW1hZ2V8ZW58MHx8MHx8fDA%3D\"'}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u8BBE\\u7F6E Canvas \\u5C3A\\u5BF8\\u4EE5\\u5339\\u914D\\u56FE\\u7247\\u5C3A\\u5BF8\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      canvas\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"width \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"width\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      canvas\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"height \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"height\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u83B7\\u53D6\\u56FE\\u7247\\u6570\\u636E\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"const\"}),\" imageData \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getImageData\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"width\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" img\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"height\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"!\"}),\"imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u5E94\\u7528\\u7070\\u5EA6\\u5316\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token function\",children:\"traverseImageData\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// \\u5C06\\u4FEE\\u6539\\u540E\\u7684\\u6570\\u636E\\u91CD\\u65B0\\u7ED8\\u5236\\u5230 Canvas \\u4E0A\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        context\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"putImageData\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"imageData\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\\r\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\"div\",(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\"canvas id\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"canvas\"'}),\" ref\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),\"canvasRef\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),\"canvas\",(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),\"div\",(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\\r\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.h4,{className:\"content-header\",id:\"\\u6548\\u679C\\u5C55\\u793A\",children:[(0,n.jsx)(a.a,{href:\"#\\u6548\\u679C\\u5C55\\u793A\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.span,{className:\"content-header-link\",children:(0,n.jsxs)(a.svg,{className:\"h-5 linkicon w-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"http://www.w3.org/2000/svg\",children:[(0,n.jsx)(a.path,{d:\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}),(0,n.jsx)(a.path,{d:\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"})]})})})}),\"\\u6548\\u679C\\u5C55\\u793A\"]}),(0,n.jsx)(a.ul,{children:(0,n.jsx)(a.li,{children:(0,n.jsx)(a.a,{href:\"/projects/canvas/gray\",children:\"canvas\\u7070\\u5EA6\\u5316\\u56FE\\u7247\"})})})]})}function d(e={}){let{wrapper:a}=e.components||{};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}return v(x);})();\n;return Component;"
  },
  "_id": "articles/canvas/canvas-gray.mdx",
  "_raw": {
    "sourceFilePath": "articles/canvas/canvas-gray.mdx",
    "sourceFileName": "canvas-gray.mdx",
    "sourceFileDir": "articles/canvas",
    "contentType": "mdx",
    "flattenedPath": "articles/canvas/canvas-gray"
  },
  "type": "Blog",
  "readingTime": {
    "text": "5 min read",
    "minutes": 4.515,
    "time": 270900,
    "words": 903
  },
  "slug": "canvas/canvas-gray",
  "path": "articles/canvas/canvas-gray",
  "filePath": "articles/canvas/canvas-gray.mdx",
  "toc": [
    {
      "value": "React 和 Canvas: 使用 ImageData 处理图片灰度化效果",
      "url": "#react-和-canvas-使用-imagedata-处理图片灰度化效果",
      "depth": 3
    },
    {
      "value": "步骤 1：项目准备",
      "url": "#步骤-1项目准备",
      "depth": 4
    },
    {
      "value": "核心功能实现",
      "url": "#核心功能实现",
      "depth": 3
    },
    {
      "value": "加载图片",
      "url": "#加载图片",
      "depth": 4
    },
    {
      "value": "绘制图片",
      "url": "#绘制图片",
      "depth": 4
    },
    {
      "value": "获取 ImageData",
      "url": "#获取-imagedata",
      "depth": 4
    },
    {
      "value": "遍历和修改 ImageData 数据",
      "url": "#遍历和修改-imagedata-数据",
      "depth": 4
    },
    {
      "value": "整合代码",
      "url": "#整合代码",
      "depth": 4
    },
    {
      "value": "效果展示",
      "url": "#效果展示",
      "depth": 4
    }
  ],
  "structuredData": {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "使用 canvas 实现灰度化图片",
    "datePublished": "2016-03-08T00:00:00.000Z",
    "dateModified": "2016-03-08T00:00:00.000Z",
    "description": "\r",
    "image": "/static/images/twitter-card.png",
    "url": "https://github.com/ajiangpz/articles/canvas/canvas-gray"
  }
}